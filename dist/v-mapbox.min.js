/*!
  * v-mapbox v3.3.1
  * (c) 2023 GeoSpoc Dev Team
  * @license MIT
  */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("mapbox-gl"),require("vue"),require("@deck.gl/layers"),require("@deck.gl/mapbox")):"function"==typeof define&&define.amd?define(["exports","mapbox-gl","vue","@deck.gl/layers","@deck.gl/mapbox"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).VMapbox={},e.mapboxGl,e.vue,e.deckGlLayers,e.deckGlMapbox)}(this,(function(e,o,t,r,a){"use strict";const n=Symbol("Map");function l(e,o){const r=t.inject(e,o);if(!r)throw new Error(`Could not resolve ${e.description}`);return r}var u=t.defineComponent({name:"VControlAttribution",props:{options:{type:Object,default:()=>({compact:!1,customAttribution:"Map design by me"}),required:!0},position:{type:String,default:()=>"bottom-right",required:!1}},setup(e,{slots:r}){let a=l(n);t.onMounted((()=>{!function(){const t={...e.options};r&&r.default()&&Array.isArray(r.default())&&(t.customAttribution=r.default().at(0).el.data);const n=new o.AttributionControl(t);a.value.addControl(n,e.position)}()}))}});u.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(e.$slots,"default")])},u.__file="src/controls/VControlAttribution.vue";var d=t.defineComponent({name:"VControlFullscreen",props:{options:{type:Object,default:()=>({}),required:!0},position:{type:String,default:()=>"top-left",required:!1}},setup(e){let r=l(n);t.onMounted((()=>{!function(){const t=new o.FullscreenControl(e.options);r.value.addControl(t,e.position)}()}))}});d.__file="src/controls/VControlFullscreen.vue";const s=["geolocate","error","outofmaxbounds","trackuserlocationstart","trackuserlocationend"];var i=t.defineComponent({name:"VControlFullscreen",props:{options:{type:Object,default:()=>({}),required:!0},position:{type:String,default:()=>"top-left",required:!1}},setup(e,{emit:r}){let a=l(n);t.onMounted((()=>{!function(){const t=new o.GeolocateControl(e.options);a.value.addControl(t,e.position),s.forEach((e=>{t.on(e,(()=>{r(e)}))}))}()}))}});i.__file="src/controls/VControlGeolocate.vue";var c=t.defineComponent({name:"VControlFullscreen",props:{options:{type:Object,default:()=>({}),required:!0},position:{type:String,default:()=>"top-left",required:!1}},setup(e){let r=l(n);t.onMounted((()=>{!function(){const t=new o.NavigationControl(e.options);r.value.addControl(t,e.position)}()}))}});c.__file="src/controls/VControlNavigation.vue";var p=t.defineComponent({name:"VControlFullscreen",props:{options:{type:Object,default:()=>({}),required:!0},position:{type:String,default:()=>"bottom-left",required:!1}},setup(e){let r=l(n);t.onMounted((()=>{!function(){const t=new o.ScaleControl(e.options);r.value.addControl(t,e.position)}()}))}});p.__file="src/controls/VControlScale.vue";var f=t.defineComponent({name:"VLayerDeckArc",props:{layerId:{type:String,default:"deck.gl-arc-layer",required:!0},data:{type:Object,required:!0},options:{type:Object,required:!0},before:{type:String,default:"",required:!1}},setup(e){let o=l(n),u=t.ref(!1);const d=new a.MapboxLayer({...e.options,id:e.layerId,data:e.data,type:r.ArcLayer});function s(){o.value.addLayer(d,e.before)}o.value.on("style.load",(()=>{const e=()=>{o.value.isStyleLoaded()?u.value=!0:(u.value=!1,setTimeout(e,200))};e()})),t.watch(u,(e=>{e&&s()})),t.onMounted((()=>{s()}))}});f.__file="src/layers/deck.gl/VLayerDeckArc.vue";var y=t.defineComponent({name:"VLayerDeckGeojson",props:{layerId:{type:String,default:"deck.gl-geojson-layer",required:!0},data:{type:Object,required:!0},options:{type:Object,required:!0},before:{type:String,default:"",required:!1}},setup(e){let o=l(n),u=t.ref(!1);const d=new a.MapboxLayer({...e.options,id:e.layerId,data:e.data,type:r.GeoJsonLayer});function s(){o.value.addLayer(d,e.before)}o.value.on("style.load",(()=>{const e=()=>{o.value.isStyleLoaded()?u.value=!0:(u.value=!1,setTimeout(e,200))};e()})),t.watch(u,(e=>{e&&s()})),t.onMounted((()=>{s()}))}});y.__file="src/layers/deck.gl/VLayerDeckGeojson.vue";var v=t.defineComponent({name:"VLayerMapboxCanvas",props:{sourceId:{type:String,default:"mapbox.gl-canvas-source",required:!0},layerId:{type:String,default:"mapbox.gl-canvas-layer",required:!0},source:{type:Object,required:!0},layer:{type:Object,default:()=>({}),required:!0},before:{type:String,default:"",required:!1}},setup(e){let o=l(n),r=t.ref(!1);const a={...e.layer,id:e.layerId,source:e.sourceId},u={type:"geojson",data:e.source};function d(){o.value.addSource(e.sourceId,u),o.value.addLayer(a,e.before)}o.value.on("style.load",(()=>{const e=()=>{o.value.isStyleLoaded()?r.value=!0:(r.value=!1,setTimeout(e,200))};e()})),t.watch(r,(e=>{e&&d()})),t.onMounted((()=>{d()}))}});v.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(e.$slots,"default")])},v.__file="src/layers/mapbox/VLayerMapboxCanvas.vue";const m=["click","dblclick","mousedown","mouseup","mousemove","mouseenter","mouseleave","mouseover","mouseout","contextmenu","touchstart","touchend","touchcancel"],b=["error","load","idle","remove","render","resize","webglcontextlost","webglcontextrestored","dataloading","data","tiledataloading","sourcedataloading","styledataloading","sourcedata","styledata","boxzoomcancel","boxzoomstart","boxzoomend","touchcancel","touchmove","touchend","touchstart","click","contextmenu","dblclick","mousemove","mouseup","mousedown","mouseout","mouseover","movestart","move","moveend","zoomstart","zoom","zoomend","rotatestart","rotate","rotateend","dragstart","drag","dragend","pitchstart","pitch","pitchend","wheel"],g=["dragstart","drag","dragend"],k=["click","mouseenter","mouseleave"],S=["open","close"];var q=t.defineComponent({name:"VLayerMapboxGeojson",props:{sourceId:{type:String,default:"mapbox.gl-geojson-source",required:!0},layerId:{type:String,default:"mapbox.gl-geojson-layer",required:!0},source:{type:Object,required:!0},layer:{type:Object,default:()=>({}),required:!0},before:{type:String,default:"",required:!1}},setup(e,{emit:o}){let r=l(n),a=t.ref(!1),u=t.ref(m);const d={...e.layer,id:e.layerId,source:e.sourceId};function s(){r.value.addSource(e.sourceId,e.source),r.value.addLayer(d,e.before)}r.value.on("style.load",(()=>{const e=()=>{r.value.isStyleLoaded()?a.value=!0:(a.value=!1,setTimeout(e,200))};e()})),t.watch(a,(e=>{e&&s()})),t.onMounted((()=>{s(),u.value.forEach((t=>{r.value.on(t,e.layerId,(e=>{o(t,e)}))}))})),t.onBeforeUnmount((()=>{r.value.getLayer(e.layerId)&&(r.value.removeLayer(e.layerId),r.value.removeSource(e.sourceId))}))}});q.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(e.$slots,"default")])},q.__file="src/layers/mapbox/VLayerMapboxGeojson.vue";var x=t.defineComponent({name:"VLayerMapboxImage",props:{sourceId:{type:String,default:"mapbox.gl-image-source",required:!0},layerId:{type:String,default:"mapbox.gl-image-layer",required:!0},source:{type:Object,required:!0},layer:{type:Object,default:()=>({}),required:!0},before:{type:String,default:"",required:!1}},setup(e){let o=l(n),r=t.ref(!1);const a={...e.layer,id:e.layerId,source:e.sourceId};function u(){o.value.addSource(e.sourceId,e.source),o.value.addLayer(a,e.before)}o.value.on("style.load",(()=>{const e=()=>{o.value.isStyleLoaded()?r.value=!0:(r.value=!1,setTimeout(e,200))};e()})),t.watch(r,(e=>{e&&u()})),t.onMounted((()=>{u()}))}});x.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(e.$slots,"default")])},x.__file="src/layers/mapbox/VLayerMapboxImage.vue";var L=t.defineComponent({name:"VLayerMapboxRaster",props:{sourceId:{type:String,default:"mapbox.gl-raster-source",required:!0},layerId:{type:String,default:"mapbox.gl-raster-layer",required:!0},source:{type:Object,required:!0},layer:{type:Object,default:()=>({}),required:!0},before:{type:String,default:"",required:!1}},setup(e){let o=l(n),r=t.ref(!1);const a={...e.layer,id:e.layerId,source:e.sourceId},u={type:"geojson",data:e.source};function d(){o.value.addSource(e.sourceId,u),o.value.addLayer(a,e.before)}o.value.on("style.load",(()=>{const e=()=>{o.value.isStyleLoaded()?r.value=!0:(r.value=!1,setTimeout(e,200))};e()})),t.watch(r,(e=>{e&&d()})),t.onMounted((()=>{d()}))}});L.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(e.$slots,"default")])},L.__file="src/layers/mapbox/VLayerMapboxRaster.vue";var V=t.defineComponent({name:"VLayerMapboxVector",props:{sourceId:{type:String,default:"mapbox.gl-vector-source",required:!0},layerId:{type:String,default:"mapbox.gl-vector-layer",required:!0},source:{type:Object,required:!0},layer:{type:Object,default:()=>({}),required:!0},before:{type:String,default:"",required:!1}},setup(e){let o=l(n),r=t.ref(!1);const a={...e.layer,id:e.layerId,source:e.sourceId};function u(){o.value.addSource(e.sourceId,e.source),o.value.addLayer(a,e.before)}o.value.on("style.load",(()=>{const e=()=>{o.value.isStyleLoaded()?r.value=!0:(r.value=!1,setTimeout(e,200))};e()})),t.watch(r,(e=>{e&&u()})),t.onMounted((()=>{u()}))}});V.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(e.$slots,"default")])},V.__file="src/layers/mapbox/VLayerMapboxVector.vue";var M=t.defineComponent({name:"VLayerMapboxVideo",props:{sourceId:{type:String,default:"mapbox.gl-video-source",required:!0},layerId:{type:String,default:"mapbox.gl-video-layer",required:!0},source:{type:Object,required:!0},layer:{type:Object,default:()=>({}),required:!0},before:{type:String,default:"",required:!1}},setup(e){let o=l(n),r=t.ref(!1);const a={...e.layer,id:e.layerId,source:e.sourceId};function u(){o.value.addSource(e.sourceId,e.source),o.value.addLayer(a,e.before)}o.value.on("style.load",(()=>{const e=()=>{o.value.isStyleLoaded()?r.value=!0:(r.value=!1,setTimeout(e,200))};e()})),t.watch(r,(e=>{e&&u()})),t.onMounted((()=>{u()}))}});M.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",null,[t.renderSlot(e.$slots,"default")])},M.__file="src/layers/mapbox/VLayerMapboxVideo.vue";var C=t.defineComponent({name:"VMap",props:{options:{type:Object,required:!0,default:()=>({})}},setup(e,{emit:r}){let a=t.ref({}),l=t.ref(!1),u=t.ref(b);t.onMounted((()=>{const d="container"in e.options?e.options:{...e.options,container:"map"};a.value=new o.Map(d),l.value=!0,t.provide(n,a),u.value.forEach((e=>{a.value.on(e,(o=>{"load"===e?r("loaded",a.value):r(e,o)}))}))}));return{getContainer:()=>Object.keys(e.options).includes("container")?`${e.options.container}`:"map"}}});const j=["id"];C.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("div",{id:e.getContainer(),class:"v-map-container"},[t.renderSlot(e.$slots,"default")],8,j)},C.__file="src/map/VMap.vue";var I=t.defineComponent({name:"VPopup",props:{marker:{type:Object,default:()=>({}),required:!1},options:{type:Object,default:()=>({}),required:!0},coordinates:{type:Object,default:()=>({}),required:!0}},setup(e,{emit:r}){let a=l(n),u=new o.Popup(e.options),d=t.ref(!0);const s=t.ref(null);function i(){u.remove(),r("removed")}function c(){S.forEach((e=>{u.off(e,(()=>{r(e)}))}))}return a.value.on("style.load",(()=>{const e=()=>{a.value.isStyleLoaded()?d.value=!0:(d.value=!1,setTimeout(e,200))};e()})),t.onMounted((()=>{d.value?(u.setDOMContent(s.value),u.setLngLat(e.coordinates),function(){e.marker&&0!==Object.keys(e.marker).length?e.marker.setPopup(u):u.addTo(a.value);r("added",{popup:u})}(),S.forEach((e=>{u.on(e,(()=>{r(e)}))}))):(i(),c())})),t.onBeforeUnmount((()=>{i(),c()})),{content:s}}});const _=["id"];I.render=function(e,o,r,a,n,l){return t.openBlock(),t.createElementBlock("section",{id:`popup-${Date.now()}`,ref:"content"},[t.renderSlot(e.$slots,"default")],8,_)},I.__file="src/popups/VPopup.vue";var h=t.defineComponent({name:"VMarker",components:{VPopup:I},props:{options:{type:Object,default:()=>({}),required:!0},popupOptions:{type:Object,default:()=>({}),required:!0},coordinates:{type:[Object,Array],default:()=>({}),required:!0},cursor:{type:String,default:"pointer",required:!1}},setup(e,{emit:r}){let a=l(n),u=t.ref({}),d=t.ref(!0),s=t.ref(!1),i=t.ref(null);function c(o){o.setLngLat(e.coordinates)}function p(o){o.getElement().style.cursor=e.cursor||"default"}function f(e){e.addTo(a.value),r("added",{marker:e})}function y(e){s.value&&(e.remove(),r("removed"))}function v(o){let t;g.forEach((a=>{o.on(a,(o=>{"dragend"===a&&(t=e.coordinates instanceof Array?[o.target._lngLat.lng,o.target._lngLat.lat]:o.target._lngLat,r("update:coordinates",t)),r(a,o)}))})),k.forEach((e=>{o.getElement().addEventListener(e,(o=>{r(e,o)}))}))}return t.watch(u,(e=>{s.value="_map"in e})),t.onMounted((()=>{d.value?null!==i.value?(u.value=new o.Marker({element:i.value,...e.options}),c(u.value),f(u.value),p(u.value),v(u.value)):(u.value=new o.Marker(e.options),c(u.value),f(u.value),p(u.value),v(u.value)):y(u.value)})),t.onBeforeUnmount((()=>{y(u.value)})),a.value.on("style.load",(()=>{const e=()=>{a.value.isStyleLoaded()?d.value=!0:(d.value=!1,setTimeout(e,200))};e()})),{isMarkerAvailable:s,marker:u,setSlotRef:e=>{i.value=e}}}});const O=["id"];h.render=function(e,o,r,a,n,l){const u=t.resolveComponent("v-popup");return t.openBlock(),t.createElementBlock("section",{id:`marker-${Date.now()}`,class:"absolute"},[t.renderSlot(e.$slots,"markers",{setRef:e.setSlotRef}),e.isMarkerAvailable?(t.openBlock(),t.createBlock(u,{key:0,marker:e.marker,options:e.popupOptions,coordinates:e.coordinates},{default:t.withCtx((()=>[t.renderSlot(e.$slots,"default")])),_:3},8,["marker","options","coordinates"])):t.createCommentVNode("v-if",!0)],8,O)},h.__file="src/markers/VMarker.vue",e.VControlAttribution=u,e.VControlFullscreen=d,e.VControlGeolocate=i,e.VControlNavigation=c,e.VControlScale=p,e.VLayerDeckArc=f,e.VLayerDeckGeojson=y,e.VLayerMapboxCanvas=v,e.VLayerMapboxGeojson=q,e.VLayerMapboxImage=x,e.VLayerMapboxRaster=L,e.VLayerMapboxVector=V,e.VLayerMapboxVideo=M,e.VMap=C,e.VMarker=h,e.VPopup=I,e.default=C,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=v-mapbox.min.js.map
